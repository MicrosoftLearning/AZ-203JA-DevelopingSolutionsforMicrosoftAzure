---
lab:
    title: 'ラボ: イメージとコンテナを使用してコンピューティング ワークロードをデプロイする'
    type: 'Answer Key'
    module: 'モジュール 1: サービスとしての Azure インフラストラクチャの開発 (IaaS) コンピューティング ソリューション'
---

# ラボ: イメージとコンテナを使用してコンピューティング ワークロードをデプロイする
# 受講ラボの解答キー

## Microsoft Azure ユーザー インターフェイス

Microsoft クラウド ツールのダイナミックな性質を考えると、このトレーニング コンテンツの開発後に Azure ユーザー インターフェイス (UI) の変更が発生する可能性があります。これらの変更により、演習の手順と演習手順が一致しない場合があります。

Microsoft は、コミュニティが必要な変更を行うとすぐに、このトレーニング コースを更新します。しかし、クラウド更新が頻繁に起きるため、この研修内容が更新される前に、UI の変更を経験するかも知れません。**その場合は変更に順応して、必要に応じてラボでをそれを処理してください。**

## 指示

### 開始する前に

#### ラボの仮想マシンへのサインイン

  - 次の認証情報を使用して**Windows 10** 仮想マシンにサインインします。
    
      - **ユーザー名**：Admin
    
      - **パスワード**: Pa55w.rd

> > **注記**：ラボ仮想マシンのサインイン手順は、インストラクターから提供されます。

#### インストールされたアプリケーションの検討

  - **Windows 10** デスクトップの下部にあるタスク バーを確認します。タスク バーには、このラボで使用するアプリケーションのアイコンが含まれています。
    
      - Microsoft Edge
    
      - エクスプローラ

### エクササイズ 1: Azure portal を使用した仮想マシンの作成

#### タスク 1: Azure portalを開く

1.  タスク バーで、**Microsoft Edge** アイコンを選択します。

2.  開いているブラウザ ウインドウで、**Azure portal** ([portal.azure.com](https://portal.azure.com))に移動します。

3.  Microsoft アカウントの **電子メール アドレス** を入力します。

4.  **次へ** を選択します。

5.  Microsoft アカウントの **パスワード** を入力します。

6.  **サインイン** を選択します。

> > 注記： **Azure portal** に初めてサインインする場合は、ポータルのツアーを提供するダイアログ ボックスが表示されます。ポータルの使用を開始するには、**開始** を選択します。

#### タスク 2: リソース グループの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成** リンクを選択します。 

> 注記： **リソースの作成** リンクが見つからない場合、ポータルの左側にある [リソースを作成] アイコンはプラス記号文字となります。 

2.  **新しい** ブレードの上部で、 おすすめサービスの一覧の上にある **マーケットプレースの検索** テキスト ボックスを検索します。

3.  検索テキスト ボックスに、テキスト **リソース グループ** を入力し、Enterキーを押します。 

4.  **すべて** の 検索結果] ブレードで、**リソース グループの結果** を選択します。

5.  **リソース グループ** ブレードで、**作成** を選択 します。   

6.  追加の **リソース グループ** ブレードで、**基本** などのブレードの上部にあるタブを確認します。   

> 注記：各タブは、ワークフロー内の新しい **リソース グループ** を作成するためのステップを表します。  いつでも **レビュー + 作成** を選択して、残りのタブをスキップできます。 

7.  **基本** タブで、次の操作を実行します：
    
    1.  **サブスクリプション** テキスト ボックスは既定値のままにします。
    
    2.  **リソース グループ** テキスト ボックスに、**ContainerCompute** の値を入力します。   
    
    3.  **リージョン** ドロップダウン リストで、**米国東部** の場所を選択します。
    
    4.  **レビュー +** **作成** を選択します。   

8.  **レビュー + 作成** タブで、前の手順で選択したオプションを確認します。 

9.  指定したコンフィギュレーションを使用してリソース グループを作成するには、**作成** を選択します。

10. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 3: Linux 仮想マシンリソースの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成** リンクを選択します。

2.  **新しい** ブレードの上部で、 おすすめサービスの一覧の上にある **マーケットプレースの検索** テキスト ボックスを検索します。

3.  フィルター テキスト ボックスに **Ubuntu Server 18** と入力して、Enterキーを押します。

4.  **すべて** 検索結果 ブレードで、**Ubuntu Server 18.04 LTS** の結果を選択します。  

5.  **Ubuntu サーバー 18.04 LTS** ブレードで、**作成** を選択 します。   

6.  **仮想マシンを作成** ブレードで、**基本** や **ディスク** などのブレードの上部にあるタブを確認します。

> 注記：各タブは、ワークフロー内の新しい **仮想マシン** を作成するためのステップを表します。いつでも **レビュー + 作成** を選択して、残りのタブをスキップできます。

7.  **基本** タブで、次の操作を実行します：
    
    1.  **サブスクリプション** テキスト ボックスは既定値のままにします。
    
    2.  **リソース グループ** セクションで、既存の **ContainerCompute** オプションを選択します。 
    
    3.  **仮想マシン名** テキスト ボックスに、**simplevm** を入力します。
    
    4.  **リージョン** ドロップダウン リストで、**米国東部** の場所を選択します。
    
    5.  **イメージ** テキスト ボックスで、**Ubuntu Server 18.04 LTS** オプションが選択されていることを確認します。 
    
    6.  **サイズ** テキスト ボックスで、**サイズの変更** リンクを選択します。 

8.  **VM サイズの選択** ブレードで、次の操作を実行します。

<!-- end list -->

1.  サイズのリストから **B1s** オプションを選択します。 

2.  **選択** を押します。

<!-- end list -->

9.  **基本** タブに戻り、次の操作を実行します。

<!-- end list -->

1.  **認証の種類** セクションで、**パスワード** を選択します。

2.  **データベース** 名 テキスト ボックスに、**Student** を入力します。

3.  **パスワード** と **パスワードの確認** フィールドに、**StudentPa55w.rd** と入力します。

4.  **Azure Active Directory を使用してログイン** セクションで、**オフ** を選択します。   

5.  **パブリックインバウンド ポート** セクションで、**選択したポートを許可する** を選択します。 

6.  **選択した着信ポート** ドロップダウン リストで、**SSH (22)** のみを選択します。 

7.  **次へ** を選択します:** Disks \>**.

<!-- end list -->

10. **ディスク** タブで、次の操作を実行します：

<!-- end list -->

1.  **OS ディスクの種類** セクションで、**標準 SSD** を選択します。

2.  **レビュー + 作成** を選択します。

<!-- end list -->

11. **レビュー + 作成** タブで、前の手順で選択したオプションを確認します。

12. 指定した構成を使用してVMを作成するには、**作成** を選択します。

13. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: 仮想マシンのバックアップ

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ** リンクを選択します。 

2.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。 

3.  **ContainerCompute** ブレードで、この実習ラボで前に作成した **simplevm** VMを選択します。 

4.  **バーチャルマシン** ブレードで、**接続** を選択します。

5.  **表示される仮想マシンに接続** するポップアップで、次の操作を実行します。
    
    1.  **IP アドレス** テキスト ボックスで、**パブリック IP アドレス** を選択します。
    
    2.  **ポート番号** テキスト ボックスに、**22** と入力します。
    
    3.  **VM ローカルアカウントを使用してログイン** テキストボックス内のテキストを **コピー** します。  

> 注記：コピーしたコマンドは、リモート コンピュータから SSH を使用して VM に接続します。このコマンドは、演習の後半で使用します。

6.  ポータルの上部で、**Cloud Shell** アイコンを選択して新しいシェル インスタンスを開きます。

> 注記：**Cloud Shell** アイコンは、シンボルとアンダースコア文字より大きい文字で表されます。 

![](media/image1.png)

7.  サブスクリプションを使用して初めて **Cloud Shell** を開く場合は、初めて使用する **Cloud Shell** を構成できる **Azure Cloud シェルへようこそウィザード** が表示されます。 ウィザードで次の操作を実行します。
    
    4.  Bash または PowerShell の間で選択が行われた場合は、**Bash** オプションを選択します。 
    
    5.  シェルの使用を開始する新しいストレージ アカウントを作成するように求めるダイアログ ボックスが表示されます。既定の設定を受け入れ、**ストレージの作成** を選択します。 
    
    6.  **Cloud Shell** が初回のセットアップ手順を完了するのを待ってから、ラボを進めます。 

> > 注記：**Cloud Shell** の構成オプションが表示されない場合は、このコースの演習で既存のサブスクリプションを使用している可能性が高いと考えられます。 演習は、新しいサブスクリプションを使用していると仮定して作成されます。

8.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで、 この演習で前にコピーしたコマンドを **貼り付け**、Enter キーを押して SSH を使用して新しい VM に接続します。   

> 注記：このコマンドは、ユーザー名と IP アドレスによって異なります。たとえば、ユーザー名が **Student** で、IP アドレスが **40.125.245.5** の場合、コマンドは **ssh Student@40.125.245.5** になります。     

9.  SSH ツールは、まずホストの信頼性を確立できないことを通知し、接続を続行するかどうかを確認します。プロンプトに **はい** と入力し、Enter キーを押して VM への接続を続行します。 

10. SSH ツールは、パスワードの入力を求められます。 **StudentPa55w.rd** を入力し、Enter キーを押して VM で認証します。 

> 注記：パスワードを入力しても文字は表示されません。予めご了承ください。

11. SSH を使用して VM に接続すると、VM に Bash シェルのプロンプトが表示されます。プロンプトで次のコマンドを入力し、Enter キーを押して Linux VM のコンピュータ名を表示します。

<!-- end list -->

    uname -mnipo

12. プロンプトで次のコマンドを入力し、Enter キーを押して Linux VM の配布およびオペレーティング システムに関する情報を表示します。

<!-- end list -->

    uname -srv

13. ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### 復習

この演習では、Azure portal インターフェイスを使用して新しい VM を手動で作成し、Cloud Shell と SSH を使用して VM に接続しました。

### エクササイズ 2: Azure CLI を使用して Linux 仮想マシンを作成する 

#### タスク 1: Cloud Shell を開く

1.  Azure portal の上部ナビゲーション バーで、**Cloud Shell** アイコンを選択 して新しいシェル インスタンスを開きます。

2.  **Cloud Shell** がインスタンスへの接続を完了するのを待ってから、演習に進みます。 

3.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで次のコマンドを入力し、Enter キーを押して Azure CLI ツールのバージョンを表示します。 

<!-- end list -->

    az --version

#### タスク 2: Azure CLI を使用して、次のように入力します。

1.  次のコマンドを入力し、Enter キーを押すと、CLI のルート レベルにあるサブグループとコマンドの一覧が表示されます。

<!-- end list -->

    az --help

2.  次のコマンドを入力し、Enter キーを押すと、 **仮想マシン** のサブグループとコマンドの一覧が表示されます。

<!-- end list -->

    az vm --help

3.  次のコマンドを入力し、Enter キーを押すと、**仮想マシンの作成** コマンドの引数と例の一覧が表示されます。

<!-- end list -->

    az vm create --help

4.  次のコマンドを入力し、Enter キーを押して、次の設定で新しい **仮想マシン** を作成します。
    
      - **リソースグループ**: ContainerCompute
    
      - **名前**: quickvm
    
    <!-- end list -->
    
      - **画像**: Debian
    
      - **ユーザー名**：受講者
    
      - **パスワード**: StudentPa55w.rd

<!-- end list -->

    az vm create --resource-group ContainerCompute --name quickvm --image Debian --admin-username student --admin-password StudentPa55w.rd

5.  VM 作成のプロセスが完了するまで待ちます。プロセスが完了すると、コマンドはマシンに関する詳細を含む JSON ファイルを返します。

6.  次のコマンドを入力し、Enter キーを押すと、新しく作成された VM に関するさまざまなメタデータを含む、より詳細な JSON ファイルが表示されます。

<!-- end list -->

    az vm show --resource-group ContainerCompute --name quickvm

7.  次のコマンドを入力し、Enter キーを押して、VM に関連付けられているすべての IP アドレスを一覧表示します。

<!-- end list -->

    az vm list-ip-addresses --resource-group ContainerCompute --name quickvm

8.  次のコマンドを入力し、Enter キーを押して出力をフィルタリングし、最初の IP アドレス値のみを返します。

<!-- end list -->

    az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv

9.  次のコマンドを入力し、Enter キーを押して前のコマンドの結果を *ipAddress* という名前の新しい Bash シェル変数に格納します。

<!-- end list -->

    ipAddress=$(az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv)

10. 次のコマンドを入力し、Enter キーを押して Bash シェル変数 *ipAddress* の値を印刷します。

<!-- end list -->

    echo $ipAddress

11. 次のコマンドを入力し、Enter キーを押して、SSH ツールと Bash シェル変数 *ipAddress* に格納されている IP アドレスを使用して、この演習で前に作成した VM に接続します。

<!-- end list -->

    ssh student@$ipAddress

12. **SSH** ツールは、まずホストの信頼性を確立できないことを通知し、接続を続行するかどうかを確認します。 **はい** と入力し、Enter キーを押して VM への接続を続行します。 

13. **SSH** ツールは、パスワードの入力を求められます。 **StudentPa55w.rd** を入力し、Enter キーを押して VM で認証します。

14. SSH を使用して VM に接続したら、次のコマンドを入力し、Enter キーを押して Linux VM を説明するメタデータを表示します。

<!-- end list -->

    uname -a

15. ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### 復習

この演習では、Azure Cloud Shell を使用して、自動化されたスクリプトの一部として VM を作成しました。

### エクササイズ 3: Docker コンテナー イメージを作成し、Azure Container Registry にデプロイする

#### タスク 1: Cloud Shell とエディタを開く

1.  Azure portalの上部ナビゲーション バーで、**Cloud Shell** アイコンを選択 して新しいシェル インスタンスを開きます。

2.  **Cloud Shell** がインスタンスへの接続を完了するのを待ってから、ラボに進みます。 

3.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで、次のコマンドを入力し、**Enter** キーを押してルート ディレクトリから **\~/clouddrive** ディレクトリに移動します。   

<!-- end list -->

    cd ~/clouddrive

4.  次のコマンドを入力し、Enter キーを押して、**\~/clouddrive** ディレクトリ内に **ipcheck** という名前の新しいディレクトリを作成します。

<!-- end list -->

    mkdir ipcheck

5.  次のコマンドを入力し、Enter キーを押してアクティブ ディレクトリを**\~/clouddrive** から **\~/clouddrive/ipcheck** に変更します。

<!-- end list -->

    cd ~/clouddrive/ipcheck

6.  次のコマンドを入力し、Enter キーを押して、現在のディレクトリに新しい.NET Core コンソール アプリケーションを作成します。

<!-- end list -->

    dotnet new console --output .--name ipcheck

7.  次のコマンドを入力し、Enter キーを押して、**Dockerfile** という名前の **\~/clouddrive/ipcheck** ディレクトリに新しいファイルを作成します。

<!-- end list -->

    touch Dockerfile

8.  次のコマンドを入力し、Enter キーを押して、現在のディレクトリのコンテキストで埋め込みグラフィカル エディタを開きます。

<!-- end list -->

    code .

#### タスク 2: .NET Core アプリケーションの作成とテスト

1.  グラフィカル エディタ内で **FILES** ペインを見つけ、**Program.cs** ファイルをダブル選択してエディタでそのファイルを開きます。   

2.  **Program.cs** ファイルの内容全体を削除します。 

3.  次のコードをコピーして **Program.cs** ファイルに貼り付けます。 

<!-- end list -->

    public class Program
    {
        public static void Main(string[] args)
        {        
            if (System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
            {
                System.Console.WriteLine("Current IP Addresses:");
                string hostname = System.Net.Dns.GetHostName();
                System.Net.IPHostEntry host = System.Net.Dns.GetHostEntry(hostname);
                foreach(System.Net.IPAddress address in host.AddressList)
                {
                    System.Console.WriteLine($"\t{address}");
                }
            }
            else
            {
                System.Console.WriteLine("No Network Connection");
            }
        }
    }

4.  グラフィカル エディタのメニューまたは **Ctrl+S** キーボード ショートカットのいずれかを使用して、**Program.cs** ファイルを **保存** します。

5.  コマンド プロンプトに戻り、次のコマンドを入力し、Enter キーを押してアプリケーションを実行します。

<!-- end list -->

    dotnet run

6.  実行の結果を確認します。Cloud Shell インスタンスには、少なくとも 1 つの IP アドレスが一覧表示されている必要があります。

7.  グラフィカル エディタ内で、  エディタの左側にある **FILES** ペインを見つけ、**Dockerfile** ファイルを二重選択してエディタでそのファイルを開きます。   

8.  次のコードを **Dockerfile** ファイルにコピーして貼り付けます。 

<!-- end list -->

    FROM microsoft/dotnet:2.2-sdk AS build
    WORKDIR /app
    
    COPY *.csproj ./
    RUN dotnet restore
    
    copy./
    RUN dotnet publish --configuration Release --output out --runtime ubuntu.18.04-x64 --self-contained
    
    FROM microsoft/dotnet:2.2-runtime
    WORKDIR /app
    COPY --from=build /app/out .

9.  グラフィカル エディタのメニューまたは **Ctrl+ S** キーボード ショートカットのいずれかを使用して、**Dockerfile** ファイルを **保存** します。

10. ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### タスク 3: Azure Container Registry  リソースの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成** リンクを選択します。

2.  **新しい** ブレードの上部で、 おすすめサービスの一覧の上にある **マーケットプレースの検索** テキスト ボックスを検索します。

3.  検索テキスト ボックスに **コンテナ** を入力し、**Enter** を押します。

4.  **すべて** 検索結果 ブレードで、**Container Registry** の結果を選択します。

5.  **Container Registry** ブレードで、**作成** を選択します。   

6.  **Container Registry の作成** ブレードで、次の操作を実行します。

<!-- end list -->

1.  **レジストリ名** テキスト ボックスで、レジストリにグローバルに一意の名前を付けます。 

> > 注記：ブレードは自動的に名前の一意性をチェックし、別の名前を選択する必要がある場合に通知します。

2.  **サブスクリプション** テキスト ボックスは既定値のままにします。

3.  **リソース グループ** ドロップダウン リストで、既存の **ContainerCompute** オプションを選択します。 

4.  **場所** テキスト ボックスで、**米国東部** を選択します。   

5.  **管理者ユーザー** セクションで、**無効化** を選択します。 

6.  **SKU** ドロップダウン リストで、**基本** を選択します。   

7.  **作成** を選択します。

<!-- end list -->

7.  演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: Cloud Shell を開き、Azure Container Registry メタデータを格納する

1.  ポータルの上部で、**Cloud Shell** アイコンを選択して新しいシェル インスタンスを開きます。

2.  **Cloud Shell** がインスタンスへの接続を完了するのを待ってから、演習に進みます。

3.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで次のコマンドを入力し、Enter キーを押してサブスクリプション内のすべてのContainer Registry の一覧を表示します。 

<!-- end list -->

    az acr list

4.  次のコマンドを入力し、Enter を押します。

<!-- end list -->

    az acr list --query "max_by([], &creationDate).name" --output tsv

5.  次のコマンドを入力し、Enter を押します。

<!-- end list -->

    acrName=$(az acr list --query "max_by([], &creationDate).name" --output tsv)

6.  次のコマンドを入力し、Enter を押します。

<!-- end list -->

    echo $acrName

#### タスク 5: Dockerコンテナー イメージを Azure Container Registry にデプロイする

1.  次のコマンドを入力し、Enter キーを押してアクティブ ディレクトリを **\~/** から  **\~/clouddrive/ipcheck** に変更します。

<!-- end list -->

    cd ~/clouddrive/ipcheck

2.  次のコマンドを入力し、Enter キーを押して現在のディレクトリの内容を表示します。

<!-- end list -->

    Dir

3.  次のコマンドを入力し、Enter キーを押してソース コードを **Container Registry** にアップロード  し、コンテナー イメージを **Azure Container Registry タスク** としてビルドします。

<!-- end list -->

    az acr build --registry $acrName --image ipcheck:latest .

4.  この演習を進める前に、ビルド タスクが完了するのを待ちます。

5.  ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### タスク 6: Azure Container Registry でコンテナー イメージを検証する

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ** リンクを選択します。

2.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

3.  **ContainerCompute** ブレードで、この実習ラボで前に作成したContainer Registry を選択します。 

4.  **Container Registry** ブレードで **サービス** セクションを見 つけ、**リポジトリ** リンクを選択します。

5.  **リポジトリ** セクションで、**ipcheck** コンテナー イメージ リポジトリを選択します。   

6.  **リポジトリ** ブレードで、**最新** のタグを選択します。   

7.  **最新の** タグを使用して、コンテナー イメージのバージョンのメタデータを確認します。

> 注記： **ID の実行** ハイパーリンクを選択して、ビルド タスクに関するメタデータを表示することもできます。 

#### 復習

この演習では、マシンの現在の IP アドレスを表示する .NET Core コンソール アプリケーションを作成しました。次にDockerfileファイルをアプリケーションに追加して、Dockerコンテナー イメージに変換できるようにしました。最後に、コンテナー イメージをAzure Container Registry にデプロイしました。

### エクササイズ 4: Azure コンテナ- インスタンスをデプロイする 

#### タスク 1: Azure Container Registry で管理者ユーザーを有効にする

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ** リンクを選択します。

2.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

3.  **ContainerCompute** ブレードで、この実習ラボで前に作成したContainer Registry を選択します。

4.  **Container Registry** ブレードで、**更新** を選択します。   

5.  **Container Registry の更新** ブレードで、次の操作を実行します。
    
    1.  **管理者ユーザー** セクションで、**有効** を選択します。
    
    2.  **保存** を選択します。

6.  **Container Registry の更新** ブレードを閉じます。

#### タスク 2: コンテナー イメージをAzure コンテナ- インスタンスに自動的にデプロイする

1.  **Container Registry** ブレードで **サービス** セクションを見 つけ、**リポジトリ** リンクを選択します。

2.  **リポジトリ** セクションで、**ipcheck** コンテナー イメージ リポジトリを選択します。

3.  **リポジトリ** ブレードで、**最新** のタグエントリのすぐ右側にある省略記号メニューを選択します。   

4.  表示されるポップアップ メニューで、**インスタンスの実行** リンクを選択します。 

5.  表示される **コンテナ- インスタンスの作成** ブレードで、次のアクションを実行します。 
    
    1.  **コンテナ-名** テキスト ボックステキスト ボックスに、**managedcompute** と入力します。 
    
    2.  **コンテナー イメージ** テキスト ボックスは、既定値のままにします。 
    
    3.  **OSの種類** セクションで、**Linux** を選択します。   
    
    4.  **サブスクリプション** テキスト ボックスは既定値のままにします。
    
    5.  **リソース グループ** ドロップダウン リストで、**ContainerCompute** を選択 します。
    
    6.  **場所** ドロップダウン リストで、**米国東部** を選択します。   
    
    7.  **コア数** ドロップダウン リストで、**2** を選択します。
    
    8.  **メモリ (GB)** テキスト ボックスに **4** を入力します。 
    
    9.  **パブリックIPアドレス** セクションで **いいえ** を選択します。
    
    10. **OK** を選択します。

6.  演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 3: コンテナー イメージを Azure コンテナ- インスタンスに手動でデプロイする

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ** リンクを選択します。

2.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

3.  **ContainerCompute** ブレードで、この実習ラボで前に作成したContainer Registry を選択します。

4.  **Container Registry** ブレードで **設定** セクションを見つけ、**アクセスキー** リンクを選択します。   

5.  **アクセス キー** セクションで、次のフィールドの値をコピーします。 
    
    1.  **ログイン サーバー**
    
    2.  **ユーザー名**
    
    3.  **パスワード**

> 注記：これらの値は、別の **コンテナ- インスタンス** を作成するときに、この演習の後半で使用します。

6.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成** リンクを選択します。

7.  **新しい** ブレードの上部で、 おすすめサービスの一覧の上にある **マーケットプレースの検索** テキスト ボックスを検索します。

8.  検索テキスト ボックスに **コンテナ** を入力し、**Enter** を押します。

9.  **すべて** 検索結果 ブレードで、**コンテナ- インスタンス** の結果を選択します。

10. **コンテナ- インスタンス** ブレードで、 **作成** を選択します。   

11. **コンテナ- インスタンスの作成** ブレードで、**基本** や **構成** などのブレードの左側にあるタブを確認します。 

> 注記：各タブは、ワークフロー内の新しい **コンテナ- インスタンス** を作成するためのステップを表します。 

12. **基本** タブで、次の操作を実行します：
    
    4.  **コンテナ名** テキスト ボックスに、**manualcompute** を入力します。
    
    5.  **コンテナー イメージの種類**セクションで、**プライベート**を選択します。
    
    6.  **コンテナー イメージ** テキスト ボックスに、前に記録した **ログイン サーバー** の値を入力し、サフィックス /**ipcheck:latest** を追加します。   

> > 注記：たとえば、**ログイン サーバー** の値が **azadmin.azurecr.io** の場合、コンテナー イメージ名は **azadmin.azurecr.io/ipcheck:latest** です。

7.  **イメージ レジストリ ログイン サーバー** テキスト ボックスに、 この演習で前に記録した **ログイン サーバー** の値を入力します。   

8.  **イメージ レジストリのユーザー名** テキスト ボックスに、この演習で前に記録した **ユーザー名** の値を入力します。   

9.  **イメージ レジストリ パスワード** テキスト ボックスに、この演習で前に記録した **パスワード** の値を入力します。   

10. **サブスクリプション** テキスト ボックスは既定値のままにします。

11. **リソース グループ** ドロップダウン リストで、**ContainerCompute** を選択 します。

12. **場所** ドロップダウン リストで、**米国東部** を選択します。

13. **OK** を選択します。

<!-- end list -->

13. **構成** タブで、次の操作を実行します： 
    
    14. **OSの種類** セクションで、**Linux** を選択します。
    
    15. **コア数** ドロップダウン リストで、**1** を選択します。
    
    16. **メモリ (GB)** テキスト ボックスに **1.5** を入力します。
    
    17. **パブリックIPアドレス** セクションで **はい** を選択します。   
    
    18. **DNS名ラベル** のテキスト ボックスを空のままにします。
    
    19. **ポート** テキスト ボックスに、**80** と入力します。 
    
    20. **オープン追加ポート** セクションで **いいえ** を選択します。
    
    21. **ポート プロトコル** ドロップダウン リストで、**TCP** を選択します。
    
    22. **ポリシーの再起動** ドロップダウン リストで、**失敗時** を選択します。 
    
    23. **環境変数** テキストボックスを空のままにします。
    
    24. **環境変数の追加** セクションで、**いいえ** を選択します。
    
    25. **コマンドオーバーライド**テキスト ボックスに **/ipcheck** を入力します。

> > 注記：**ipcheck** ツールは、この実習ラボで前に作成した.NET Coreコマンド ライン アプリケーションです。 

26. **OK** を選択します。

<!-- end list -->

14. **概要** タブで、選択したオプションを確認します。 

15. 指定したコンフィギュレーションを使用してコンテナ- インスタンスを作成するには、**OK** を選択します。

16. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: コンテナ- インスタンスが正常に実行されたことを検証する

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ** リンクを選択します。

2.  **リソース グループ** ブレードで、 この実習ラボで前に作成した**ContainerCompute** リソース グループを見つけて選択します。

3.  **ContainerCompute** ブレードで、この実習ラボで前に作成した **manualcompute** コンテナ- インスタンスを選択します。   

4.  **コンテナ- インスタンス** ブレードで**設定** セクションを見つけ、**コンテナ** リンクを選択します。

5.  **コンテナ** セクションで、**イベント** の一覧を確認します。   

> 注記：アプリケーションの実行が完了すると、コンテナは作業が完了したために終了しました。

#### 復習

この演習では、複数のメソッドを使用して、コンテナー イメージを Azure コンテナ- インスタンスにデプロイしました。手動メソッドを使用すると、デプロイをさらにカスタマイズし、コンテナの実行の一部としてタスク ベースのアプリケーションを実行することもできます。

### エクササイズ 5: サブスクリプションのクリーンアップ 

#### タスク 1: Cloud Shell を開き、リソース グループを一覧表示する

1.  ポータルの上部で、**Cloud Shell** アイコンを選択して新しいシェル インスタンスを開きます。

2.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで次のコマンドを入力し、Enterキーを押してサブスクリプション内のすべてのリソース グループを一覧表示します。

<!-- end list -->

    az group list

3.  次のコマンドを入力し、Enter キーを押して、リソース グループを削除する可能性のあるコマンドの一覧を表示します。

<!-- end list -->

    az group delete --help

#### タスク 2: リソース グループを削除する

1.  次のコマンドを入力し、Enter キーを押して **ContainerCompute** リソース グループを削除します。

<!-- end list -->

    az group delete --name ContainerCompute --no-wait --yes

2.  ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### タスク 3: アクティブなアプリケーションを閉じる

1.  現在実行中の **Microsoft Edge** アプリケーションを閉じます。

#### 復習

この実習では、この演習で使用する **リソース グループ** を削除してサブスクリプションをクリーンアップしました。

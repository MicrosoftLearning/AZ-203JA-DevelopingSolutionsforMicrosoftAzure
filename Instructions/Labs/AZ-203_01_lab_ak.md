---
lab:
    title: 'ラボ: イメージとコンテナを使用してコンピューティング ワークロードをデプロイする'
    type: 'Answer Key'
    module: 'モジュール 1: Azure サービスとしてのインフラストラクチャ (IaaS) コンピューティング ソリューションの開発'
---

# ラボ: イメージとコンテナを使用してコンピューティング ワークロードをデプロイする
# 受講者ラボ解答キー

## Microsoft Azure ユーザー インターフェイス

Microsoft クラウド ツールのダイナミックな性質を考えると、このトレーニング コンテンツの開発後に Azure ユーザー インターフェイス (UI) の変更が発生する可能性があります。これらの変更により、ラボの指示と手順が一致しない場合があります。

Microsoft は、コミュニティが必要な変更を行うとすぐに、このトレーニング コースを更新します。しかし、クラウド更新が頻繁に起きるため、この研修内容が更新される前に、UI の変更を経験するかも知れません。**その場合は変更に順応して、必要に応じてラボでをそれを処理してください。**

## 指示

### 開始する前に

#### ラボの仮想マシンへのサインイン

次の認証情報を使用して**Windows 10**仮想マシンにサインインします。
    
-   **ユーザー名**：Admin

-   **パスワード**: Pa55w.rd

> **注記**：ラボ仮想マシンのサインイン手順は、インストラクターから提供されます。

#### インストールされたアプリケーションの検討

**Windows 10** デスクトップの下部にあるタスク バーを確認します。タスク バーには、このラボで使用するアプリケーションのアイコンが含まれています。
    
-   Microsoft Edge

-   エクスプローラ

### エクササイズ 1: Azure portal を使用した仮想マシンの作成

#### タスク 1: Azure portal を開く

1.  タスク バーで、**Microsoft Edge** アイコンを選択します。

1.  開いているブラウザ ウインドウで、**Azure portal** ([portal.azure.com](https://portal.azure.com))に移動します。

1.  Microsoft アカウントの**電子メール アドレス**を入力します。

1.  **次へ** を選択します。

1.  Microsoft アカウントの**パスワード**を入力します。

1.  **サインイン** を選択します。

    > **注記**：**Azure portal** に初めてサインインする場合は、ポータルのツアーを提供するダイアログ ボックスが表示されます。ポータルの使用を開始するには、**開始** を選択します。

#### タスク 2: リソース グループの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成**リンクを選択します。

    > **注記**: **リソースの作成**リンクが見つからない場合、ポータルの左側にある [リソースを作成] アイコンはプラス記号文字となります。

1.  **新しい**ブレードの上部で、 おすすめサービスの一覧の上にある**マーケットプレースの検索**テキスト ボックスを検索します。

1.  検索テキスト ボックスに、テキスト**リソース グループ**を入力し、Enterキーを押します。

1.  **すべて**の 検索結果] ブレードで、**リソース グループの結果**を選択します。

1.  **リソース グループ** ブレードで、**作成**を選択 します。

1.  追加の **リソース グループ** ブレードで、**基本**などのブレードの上部にあるタブを確認します。

    > **注記**: 各タブは、ワークフロー内の新しい**リソース グループ**を作成するためのステップを表します。いつでも**レビュー + 作成**を選択して、残りのタブをスキップできます。

1.  **基本**タブで、次の操作を実行します：
    
    1.  **サブスクリプション**テキスト ボックスは既定値のままにします。
    
    1.  **リソース グループ** テキスト ボックスに、**ContainerCompute** の値を入力します。
    
    1.  **リージョン** ドロップダウン リストで、**(US) 米国東部**の場所を選択します。
    
    1.  **レビュー +** **作成**を選択します。

1.  **レビュー + 作成**タブで、前の手順で選択したオプションを確認します。

1.  指定したコンフィギュレーションを使用してリソース グループを作成するには、**作成**を選択します。

1. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 3: Linux 仮想マシンリソースの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成**リンクを選択します。

1.  **新しい**ブレードの上部で、 おすすめサービスの一覧の上にある**マーケットプレースの検索**テキスト ボックスを検索します。

1.  フィルター テキスト ボックスに **Ubuntu Server 18** と入力して、Enterキーを押します。

1.  **すべて**検索結果 ブレードで、**Ubuntu Server 18.04 LTS** の結果を選択します。

1.  **Ubuntu サーバー 18.04 LTS** ブレードで、**作成**を選択 します。

1.  **仮想マシンを作成** ブレードで、**基本** や **ディスク**などのブレードの上部にあるタブを確認します。

    > **注記**: 各タブは、ワークフロー内の新しい**仮想マシン**を作成するためのステップを表します。いつでも**レビュー + 作成**を選択して、残りのタブをスキップできます。

1.  **基本**タブで、次の操作を実行します：
    
    1.  **サブスクリプション**テキスト ボックスは既定値のままにします。
    
    1.  **リソース グループ** ドロップダウン リストで、既存の **ContainerCompute**nオプションを選択します。

    1.  **仮想マシン名** テキスト ボックスに、**simplevm**nを入力します。
    
    1.  **リージョン** ドロップダウン リストで、**(US) 米国東部**の場所を選択します。

    1.  [**可用性オプション**] ドロップダウン リストで、[**インフラストラクチャの冗長性が必要ありません**] が選択されていることを確認します。
    
    1.  **イメージ** テキスト ボックスで、**Ubuntu Server 18.04 LTS**オプションが選択されていることを確認します。
    
    1.  **サイズ**テキスト ボックスで、**サイズの変更**リンクを選択します。

1.  **VM サイズの選択**ブレードで、次の操作を実行します。

    1.  サイズのリストから**B1s**オプションを選択します。

    2.  **選択**を押します。

1.  **基本**タブに戻り、次の操作を実行します。

    1.  **認証の種類** セクションで、**パスワード**を選択します。

    1.  **ユーザー名**テキスト ボックスに、**Student** を入力します。

    1.  **パスワード** と**パスワードの確認** フィールドに、**StudentPa55w.rd**と入力します。

    1.  **Azure Active Directory を使用してログイン (プレビュー)** セクションで、**オフ**を選択します。

    1.  **パブリックインバウンド ポート** セクションで、**選択したポートを許可する**を選択します。

    1.  **着信ポートを選択** ドロップダウン リストで、**SSH (22)**のみを選択します。

    1.  **次へ** を選択します:** Disks \>**.

1. **ディスク**タブで、次の操作を実行します：

    1.  **OS ディスクの種類**セクションで、**標準 SSD**を選択します。

    1.  **レビュー + 作成**を選択します。

1. **レビュー + 作成**タブで、前の手順で選択したオプションを確認します。

1. 指定した構成を使用してVMを作成するには、**作成**を選択します。

1. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: 仮想マシンのバックアップ

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ**リンクを選択します。

1.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

1.  **ContainerCompute** ブレードで、この実習ラボで前に作成した **simplevm** VMを選択します。

1.  **バーチャルマシン** ブレードで、**接続**を選択します。

1.  **表示される仮想マシンに接続**するポップアップで、次の操作を実行します。
    
    1.  **IP アドレス** テキスト ボックスで、**パブリック IP アドレス**を選択します。
    
    2.  **ポート番号**テキスト ボックスに、**22**と入力します。
    
    3.  **VM ローカルアカウントを使用してログイン**テキストボックス内のテキストを**コピー**します。

        > **注意**: コピーしたコマンドは、リモート コンピュータから SSH を使用して VM に接続します。このコマンドは、ラボにて後で使用します。

1.  ポータルの上部で、**Cloud Shell** アイコンを選択して新しいシェル インスタンスを開きます。

    > **注記**：**Cloud Shell** アイコンは、シンボルとアンダースコア文字より大きい文字で表されます。

1.  サブスクリプションを使用して初めて **Cloud Shell** を開く場合は、初めて使用する **Cloud Shell** を構成できる**Azure Cloud シェルへようこそウィザード**が表示されます。ウィザードで次の操作を実行します。
    
    1.  ダイアログボックスを表示すると、シェルを使用して開始する新しいストレージ アカウントを作成するよう求めるメッセージが表示されます。既定の設定を受け入れ、**ストレージの作成**を選択します。
    
    1.  **Cloud Shell** が初回のセットアップ手順を完了するのを待ってから、ラボを進めます。

    > **注記**: **Cloud Shell** の構成オプションが表示されない場合は、このコースの演習で既存のサブスクリプションを使用している可能性が高いと考えられます。演習は、新しいサブスクリプションを使用しているという推定から記述されます。

1.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで、 この演習で前にコピーしたコマンドを**貼り付け**、Enter キーを押して SSH を使用して新しい VM に接続します。

    > **注記**: このコマンドは、ユーザー名と IP アドレスによって異なります。たとえば、ユーザー名が**Student** で、IP アドレスが**40.125.245.5 **の場合、コマンドは**ssh Student@40.125.245.5**になります。

1.  SSH ツールは、まずホストの信頼性を確立できないことを通知し、接続を続行するかどうかを確認します。プロンプトに**はい**と入力し、Enter キーを押して VM への接続を続行します。

1. SSH ツールは、パスワードの入力を求められます。**StudentPa55w.rd** を入力し、Enter キーを押して VM で認証します。

    > **注記**: パスワードを入力しても文字は表示されません。予めご了承ください。

1. SSH を使用して VM に接続すると、VM に Bash シェルのプロンプトが表示されます。プロンプトで次のコマンドを入力し、Enter キーを押して Linux VM のコンピュータ名を表示します。

    ```
    uname -mnipo
    ```

12. プロンプトで次のコマンドを入力し、Enter キーを押して Linux VM の配布およびオペレーティング システムに関する情報を表示します。

    ```
    uname -srv
    ```

13. ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### 復習

この演習では、Azure portal インターフェイスを使用して新しい VM を手動で作成し、Cloud Shell と SSH を使用して VM に接続しました。

### エクササイズ 2: Azure CLI を使用して Linux 仮想マシンを作成する 

#### タスク 1: Cloud Shell を開く

1.  Azure portal の上部ナビゲーション バーで、**Cloud Shell** アイコンを選択 して新しいシェル インスタンスを開きます。

1.  **Cloud Shell** がインスタンスへの接続を完了するのを待ってから、演習に進みます。

1.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで次のコマンドを入力し、Enter キーを押して Azure CLI ツールのバージョンを表示します。

    ```
    az --version
    ```

#### タスク 2: Azure CLI を使用して、次のように入力します。

1.  次のコマンドを入力し、Enter キーを押すと、CLI のルート レベルにあるサブグループとコマンドの一覧が表示されます。

    ```
    az --help
    ```

1.  次のコマンドを入力し、Enter キーを押すと、 **仮想マシン**のサブグループとコマンドの一覧が表示されます。

    ```
    az vm --help
    ```

1.  次のコマンドを入力し、Enter キーを押すと、**仮想マシンの作成**コマンドの引数と例の一覧が表示されます。

    ```
    az vm create --help
    ```

1.  次のコマンドを入力し、Enter キーを押して、次の設定で新しい**仮想マシン**を作成します。
    
      - **リソースグループ**: ContainerCompute
    
      - **名前**: quickvm
    
      - **画像**: Debian
    
      - **ユーザー名**：受講者
    
      - **パスワード**: StudentPa55w.rd

    ```
    az vm create --resource-group ContainerCompute --name quickvm --image Debian --admin-username student --admin-password StudentPa55w.rd
    ```

    > **注記**: `リソース グループ 'ContainerCompute'` が見つからなかったことを示すエラーでこのコマンドが失敗した場合は、このラボの開始時にリソース グループの名前を誤ったか、ログイン名に複数のサブスクリプションが関連付けられていることを意味します。  リソース グループに誤った名前を付けた場合は、コマンドで正しい名前に置き換えてください。  複数のサブスクリプションがある場合は、`az account set --subscription` コマンドを使用して適切なサブスクリプションを選択することが可能です。

1.  VM 作成のプロセスが完了するまで待ちます。プロセスが完了すると、コマンドはマシンに関する詳細を含む JSON ファイルを返します。

1.  次のコマンドを入力し、Enter キーを押すと、新しく作成された VM に関するさまざまなメタデータを含む、より詳細な JSON ファイルが表示されます。

    ```
    az vm show --resource-group ContainerCompute --name quickvm
    ```

1.  次のコマンドを入力し、Enter キーを押して、VM に関連付けられているすべての IP アドレスを一覧表示します。

    ```
    az vm list-ip-addresses --resource-group ContainerCompute --name quickvm
    ```

1.  次のコマンドを入力し、Enter キーを押すと、出力がフィルタリングされ、最初の IP アドレス値のみが返されます。

    ```
    az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv
    ```

1.  次のコマンドを入力し、Enter キーを押して前のコマンドの結果を *ipAddress* という名前の新しい Bash シェル変数に格納します。

    ```
    ipAddress=$(az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv)
    ```

1. 次のコマンドを入力し、Enter キーを押して Bash シェル変数 *ipAddress* の値を印刷します。

    ```
    echo $ipAddress
    ```

1. 次のコマンドを入力し、Enter キーを押して、SSH ツールと Bash シェル変数 *ipAddress* に格納されている IP アドレスを使用して、この演習で前に作成した VM に接続します。

    ```
    ssh student@$ipAddress
    ```

1. **SSH** ツールは、まずホストの信頼性を確立できないことを通知し、接続を続行するかどうかを確認します。**はい**と入力し、Enter キーを押して VM への接続を続行します。

1. **SSH** ツールは、パスワードの入力を求められます。**StudentPa55w.rd** を入力し、Enter キーを押して VM で認証します。

1. SSH を使用して VM に接続したら、次のコマンドを入力し、Enter キーを押して Linux VM を説明するメタデータを表示します。

    ```
    uname -a
    ```

1. ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### 復習

この演習では、Azure Cloud Shell を使用して、自動化されたスクリプトの一部として VM を作成しました。

### エクササイズ 3: Docker コンテナー イメージを作成し、Azure Container Registry にデプロイする

#### タスク 1: Cloud Shell とエディタを開く

1.  Azure portalの上部ナビゲーション バーで、**Cloud Shell** アイコンを選択 して新しいシェル インスタンスを開きます。

1.  **Cloud Shell** がインスタンスへの接続を完了するのを待ってから、ラボに進みます。

1.  ポータルの下部にある **Cloud Shell** コマンド プロンプトで、次のコマンドを入力し、**Enter** キーを押してルート ディレクトリから **\~/clouddrive** ディレクトリに移動します。

    ```
    cd ~/clouddrive
    ```

1.  次のコマンドを入力し、Enter キーを押して、**\~/clouddrive** ディレクトリ内に **ipcheck** という名前の新しいディレクトリを作成します。

    ```
    mkdir ipcheck
    ```

1.  次のコマンドを入力し、Enter キーを押してアクティブ ディレクトリを**\~/clouddrive** から **\~/clouddrive/ipcheck** に変更します。

    ```
    cd ~/clouddrive/ipcheck
    ```

1.  次のコマンドを入力し、Enter キーを押して、現在のディレクトリに新しい.NET Core コンソール アプリケーションを作成します。

    ```
    dotnet new console --output . --name ipcheck
    ```

1.  次のコマンドを入力し、Enter キーを押して、**Dockerfile**という名前の **\~/clouddrive/ipcheck** ディレクトリに新しいファイルを作成します。

    ```
    touch Dockerfile
    ```

1.  次のコマンドを入力し、Enter キーを押して、現在のディレクトリのコンテキストで埋め込みグラフィカル エディタを開きます。

    ```
    code .
    ```

#### タスク 2: .NET Core アプリケーションの作成とテスト

1.  グラフィカル エディタ内で **FILES** ペインを見つけ、**Program.cs** ファイルをダブル選択してエディタでそのファイルを開きます。

1.  **Program.cs** ファイルの内容全体を削除します。

1.  次のコードをコピーして **Program.cs** ファイルに貼り付けます。

    ```
    public class Program
    {
        public static void Main(string[] args)
        {        
            if (System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
            {
                System.Console.WriteLine("Current IP Addresses:");
                string hostname = System.Net.Dns.GetHostName();
                System.Net.IPHostEntry host = System.Net.Dns.GetHostEntry(hostname);
                foreach(System.Net.IPAddress address in host.AddressList)
                {
                    System.Console.WriteLine($"\t{address}");
                }
            }
            else
            {
                System.Console.WriteLine("No Network Connection");
            }
        }
    }
    ```

1.  グラフィカル エディタのメニューまたは **Ctrl+S** キーボード ショートカットのいずれかを使用して、**Program.cs** ファイルを**保存**します。  グラフィカル エディタは閉じないでください。

1.  コマンド プロンプトに戻り、次のコマンドを入力し、Enter キーを押してアプリケーションを実行します。

    ```
    dotnet run
    ```

1.  実行の結果を確認します。Cloud Shell インスタンスには、少なくとも 1 つの IP アドレスが一覧表示されている必要があります。

1.  グラフィカル エディタ内で、  エディタの左側にある**FILES** ペインを見つけ、**Dockerfile**ファイルを二重選択してエディタでそのファイルを開きます。

8.  次のコードを**Dockerfile**ファイルにコピーして貼り付けます。

    ```
    FROM mcr.microsoft.com/dotnet/core/sdk:2.2-alpine AS build
    WORKDIR /app

    COPY *.csproj ./
    RUN dotnet restore

    COPY . ./
    RUN dotnet publish --configuration Release --output out

    FROM mcr.microsoft.com/dotnet/core/runtime:2.2-alpine
    WORKDIR /app

    COPY --from=build /app/out .

    ENTRYPOINT ["dotnet", "ipcheck.dll"]
    ```

1.  グラフィカル エディタのメニューまたは **Ctrl+ S**キーボード ショートカットのいずれかを使用して、**Dockerfile**ファイルを**保存**します。

1. ポータルの下部にある**Cloud Shell**ペインを閉じます。

#### タスク 3: Azure Container Registry リソースの作成

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成**リンクを選択します。

1.  **新しい**ブレードの上部で、 おすすめサービスの一覧の上にある**マーケットプレースの検索**テキスト ボックスを検索します。

1.  検索テキスト ボックスに**Container Registry** を入力し、**Enter**を押します。

1.  **すべて**検索結果 ブレードで、**Container Registry** の結果を選択します。

1.  **Container Registry** ブレードで、**作成**を選択します。

1.  **Container Registry の作成** ブレードで、次の操作を実行します。

    1.  **レジストリ名**テキスト ボックスで、レジストリにグローバルに一意の名前を付けます。

        >注意: ブレードは名前の一意性を自動的に確認し、別の名前を選択する必要がある場合は通知します。

    1.  **サブスクリプション**テキスト ボックスは既定値のままにします。

    1.  **リソース グループ** ドロップダウン リストで、既存の **ContainerCompute**オプションを選択します。

    1.  **場所**テキスト ボックスで、**米国東部**を選択します。

    1.  **管理者ユーザー** セクションで、**無効化**を選択します。

    1.  **SKU** ドロップダウン リストで、**基本**を選択します。

    1.  **作成** を選択します。

1.  演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: Cloud Shell を開き、Azure Container Registry メタデータを格納する

1.  ポータルの上部で、**Cloud Shell**アイコンを選択して新しいシェル インスタンスを開きます。

1.  **Cloud Shell**がインスタンスへの接続を完了するのを待ってから、演習に進みます。

1.  ポータルの下部にある**Cloud Shell**コマンド プロンプトで次のコマンドを入力し、Enter キーを押してサブスクリプション内のすべてのContainer Registry の一覧を表示します。

    ```
    az acr list
    ```

1.  次のコマンドを入力し、Enter を押します。

    ```
    az acr list --query "max_by([], &creationDate).name" --output tsv
    ```

1.  次のコマンドを入力し、Enter を押します。

    ```
    acrName=$(az acr list --query "max_by([], &creationDate).name" --output tsv)
    ```

1.  次のコマンドを入力し、Enter を押します。

    ```
    echo $acrName
    ```

#### タスク 5: Dockerコンテナー イメージを Azure Container Registry にデプロイする

1.  次のコマンドを入力し、Enter キーを押してアクティブ ディレクトリを **\~/** から  **\~/clouddrive/ipcheck**に変更します。

    ```
    cd ~/clouddrive/ipcheck
    ```

1.  次のコマンドを入力し、Enter キーを押して、現在のディレクトリの内容を表示します。

    ```
    dir
    ```

1.  次のコマンドを入力し、Enter キーを押してソース コードを**Container Registry**にアップロード  し、コンテナー イメージを **Azure Container Registry タスク**としてビルドします。

    ```
    az acr build --registry $acrName --image ipcheck:latest .
    ```

1.  演習を進める前に、構築タスクが完了するまで待ちます。

1.  ポータルの下部にある**Cloud Shell**ペインを閉じます。

#### タスク 6: Azure Container Registry でコンテナー イメージを検証する

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ**リンクを選択します。

1.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

1.  **ContainerCompute**ブレードで、この実習ラボで前に作成したContainer Registry を選択します。

1.  **Container Registry** ブレードで**サービス**セクションを見 つけ、**リポジトリ**リンクを選択します。

1.  **リポジトリ** セクションで、**ipcheck** コンテナー イメージ リポジトリを選択します。

1.  **リポジトリ** ブレードで、**最新**のタグを選択します。

1.  **最新の**タグを使用して、コンテナー イメージのバージョンのメタデータを確認します。

    > **注記**: **ID の実行**ハイパーリンクを選択して、ビルド タスクに関するメタデータを表示することもできます。

#### 復習

この演習では、マシンの現在の IP アドレスを表示する .NET Core コンソール アプリケーションを作成しました。次に Dockerfile ファイルをアプリケーションに追加して、Docker コンテナー イメージに変換できるようにしました。最後に、コンテナー イメージをAzure Container Registry にデプロイしました。

### エクササイズ 4: Azure コンテナ- インスタンスをデプロイする 

#### タスク 1: Azure Container Registry で管理者ユーザーを有効にする

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ**リンクを選択します。

1.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

1.  **ContainerCompute** ブレードで、この実習ラボで前に作成したContainer Registry を選択します。

1.  **Container Registry** ブレードで、ブレードの上部にある**更新**を選択します。

1.  **Container Registry の更新** ブレードで、次の操作を実行します。
    
    1.  **管理者ユーザー**セクションで、**有効**を選択します。
    
    1.  **保存**を選択します。
    
1.  **Container Registry の更新**ブレードを閉じます。

#### タスク 2: コンテナー イメージをAzure コンテナ- インスタンスに自動的にデプロイする

1.  **Container Registry**ブレードで**サービス**セクションを見 つけ、**リポジトリ**リンクを選択します。

1.  **リポジトリ** セクションで、**ipcheck** コンテナー イメージ リポジトリを選択します。

1.  **リポジトリ** ブレードで、**最新**のタグエントリのすぐ右側にある省略記号メニューを選択します。

1.  表示されるポップアップ メニューで、**インスタンスの実行**リンクを選択します。

1.  表示される**コンテナ- インスタンスの作成**ブレードで、次のアクションを実行します。
    
    1.  **コンテナ-名** テキスト ボックステキスト ボックスに、**managedcompute**と入力します。
    
    1.  **コンテナー イメージ**テキスト ボックスは、既定値のままにします。
    
    1.  **OSの種類**セクションで、**Linux**を選択します。
    
    1.  **サブスクリプション**テキスト ボックスは既定値のままにします。
    
    1.  **リソース グループ** ドロップダウン リストで、**ContainerCompute**を選択 します。
    
    1.  **場所** ドロップダウン リストで、**米国東部**を選択します。
    
    1.  **コア数** ドロップダウン リストで、**2**を選択します。
    
    1.  **メモリ (GB)**テキスト ボックスに**4**を入力します。
    
    1.  **パブリックIPアドレス**セクションで**いいえ**を選択します。
    
    1. **OK** を選択します。

1.  演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 3: コンテナー イメージを Azure コンテナ- インスタンスに手動でデプロイする

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ**リンクを選択します。

1.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

1.  **ContainerCompute** ブレードで、この実習ラボで前に作成したContainer Registry を選択します。

1.  **Container Registry** ブレードで**設定**セクションを見つけ、**アクセスキー**リンクを選択します。

1.  **アクセス キー** セクションで、次のフィールドの値を記録します。
    
    1.  **ログイン サーバー**
    
    1.  **ユーザー名**
    
    1.  **パスワード**

        > **注意**: これらの値は、別の**コンテナ- インスタンス**を作成するときに、この演習の後半で使用します。

1.  ポータルの左側にあるナビゲーション メニューで、**+ リソースを作成**リンクを選択します。

1.  **新しい**ブレードの上部で、 おすすめサービスの一覧の上にある**マーケットプレースの検索**テキスト ボックスを検索します。

1.  検索テキスト ボックスに**コンテナー インスタンス** を入力し、**Enter**を押します。

1.  **すべて**検索結果 ブレードで、**コンテナ- インスタンス** の結果を選択します。

1. **コンテナ- インスタンス**ブレードで、**作成**を選択します。

1. **コンテナ- インスタンスの作成**ブレードで、**基本**や**詳細**などのブレードの左側にあるタブを確認します。

    > **注記**: 各タブは、ワークフロー内の新しい**コンテナ- インスタンス**を作成するためのステップを表します。

1. **基本**タブで、次の操作を実行します：

    1. **サブスクリプション**テキスト ボックスは既定値のままにします。

    1. **リソース グループ** ドロップダウン リストで、**ContainerCompute**を選択 します。
    
    1.  **コンテナ名** テキスト ボックスに、**manualcompute**を入力します。

    1. **リージョン** ドロップダウン リストで、**(US) 米国東部**を選択します。
    
    1.  **イメージ タイプ**セクションで、**プライベート**を選択します。
    
    1.  **イメージ名** テキスト ボックスに、前に記録した**ログイン サーバー**の値を入力し、サフィックス /**ipcheck:latest**を追加します。

        > **注意**: たとえば、**ログイン サーバー**の値が**azadmin.azurecr.io**の場合、コンテナー イメージ名は**azadmin.azurecr.io/ipcheck:latest**です。

    1.  **イメージ レジストリ ログイン サーバー** テキスト ボックスに、 この演習で前に記録した**ログイン サーバー**の値を入力します。

    1.  **イメージ レジストリのユーザー名**テキスト ボックスに、この演習で前に記録した**ユーザー名**の値を入力します。

    1.  **イメージ レジストリ パスワード**テキスト ボックスに、この演習で前に記録した**パスワード**の値を入力します。

    1. **OSの種類**セクションで、**Linux**を選択します。

    1. **サイズ** セクションで、**サイズの変更**リンクを選択します。

    1. **コンテナー サイズの変更**ブレードで、次の操作を実行します。

        1. [**CPU コア数**] テキスト ボックスに「**1**」と入力します。

        1. **メモリ (GiB)**テキスト ボックスに「**1.5**」と入力します。

        1. **GPU タイプ**のドロップダウン リストの既定値はそのままにします。 

        1. **OK** を選択します。
    
    1. **次へ** 選択します: **ネットワーク**

1. **ネットワーク** タブで、次の操作を実行します：
    
    1. **Public IP Address を含む** セクションで**はい**を選択します。

    1. [**ポート**] セクションで、ポート プロトコル **TCP** を使用してポート **80** が存在することを確認します。
    
    1. **DNS名ラベル**のテキスト ボックスを空のままにします。

    1. **次へ** 選択します:** 詳細**。

1. **詳細**タブで、次の操作を実行します：
    
    1. **ポリシーの再起動** ドロップダウン リストで、**失敗時**を選択します。
    
    1. **環境変数**テキストボックスを空のままにします。
    
    1. **コマンド オーバーライド**テキストボックスを空のままにします。

    1. **レビュー + 作成**を選択します。

1. **レビュー + 作成**タブで、選択したオプションを確認します。

1. 指定したコンフィギュレーションを使用してコンテナ- インスタンスを作成するには、**作成**を選択します。

1. 演習を進める前に、作成タスクが完了するまで待ちます。

#### タスク 4: コンテナ- インスタンスが正常に実行されたことを検証する

1.  ポータルの左側にあるナビゲーション メニューで、**リソース グループ**リンクを選択します。

1.  **リソース グループ** ブレードで、 この実習ラボで前に作成した **ContainerCompute** リソース グループを見つけて選択します。

1.  **ContainerCompute** ブレードで、この実習ラボで前に作成した**manualcompute**コンテナ- インスタンスを選択します。

1.  **コンテナ- インスタンス** ブレードで**設定**セクションを見つけ、**コンテナ**リンクを選択します。

1.  **コンテナ**セクションで、**イベント**の一覧を確認します。

1.  [**ログ**] タブを選択し、コンテナー インスタンスのテキスト ログを確認します。
> **注記**: 必要に応じて、**managedcompute** コンテナー インスタンスから**イベント**と**ログ**を表示することもできます。

> **注記**: アプリケーションの実行が完了すると、コンテナは作業が完了したために終了しました。  手動で作成したコンテナー インスタンスの場合、正常な終了が許容されるように設定したため、コンテナーには単一の実行が表示されます。  自動的に作成されたインスタンスではこのオプションは提供されず、コンテナーは常に実行されている必要があるため、コンテナーの再起動が繰り返し表示されます。

#### 確認

この演習では、複数のメソッドを使用して、コンテナー イメージを Azure コンテナ- インスタンスにデプロイしました。手動メソッドを使用すると、デプロイをさらにカスタマイズし、コンテナの実行の一部としてタスク ベースのアプリケーションを実行することもできます。

### エクササイズ 5: サブスクリプションのクリーンアップ 

#### タスク 1: Cloud Shell を開き、リソース グループを一覧表示する

1.  ポータルの上部で、**Cloud Shell**アイコンを選択して新しいシェル インスタンスを開きます。

1.  ポータルの下部にある**Cloud Shell**コマンド プロンプトで次のコマンドを入力し、Enterキーを押してサブスクリプション内のすべてのリソース グループを一覧表示します。

    ```
    az group list
    ```

1.  次のコマンドを入力し、Enter キーを押して、リソース グループを削除する可能性のあるコマンドの一覧を表示します。

    ```
    az group delete --help
    ```

#### タスク 2: リソース グループを削除する

1.  次のコマンドを入力し、Enter キーを押して **ContainerCompute** リソース グループを削除します。

    ```
    az group delete --name ContainerCompute --no-wait --yes
    ```

1.  ポータルの下部にある **Cloud Shell** ペインを閉じます。

#### タスク 3: アクティブなアプリケーションを閉じる

1.  現在実行中の **Microsoft Edge** アプリケーションを閉じます。

#### 復習

この実習では、この演習で使用する **リソース グループ** を削除してサブスクリプションをクリーンアップしました。
